{
  "name": "JEDI-214_Shopify_Fulfillment",
  "type": "only_mapped_keys",
  "mapping": "{\n  \"fulfillment\": {\n    \"address1\": interchanges[0].groups[0].transaction_sets[0].heading.name_N1_loop[1].address_information_N3[0].address_information_01,\n    \"city\": interchanges[0].groups[0].transaction_sets[0].heading.name_N1_loop[1].geographic_location_N4.city_name_01,\n    \"country\": (\n      $country := interchanges[0].groups[0].transaction_sets[0].heading.name_N1_loop[0].geographic_location_N4.country_code_04;\n      $lookupTable($tables.country, \"sourceCountry\", $country).targetCountry\n    ),\n    \"created_at\": $convertDateTime($now(), $dateTime.RFC3339Millis, $dateTime.RFC3339Millis, \"UTC\", \"-05:00\"),\n    \"estimated_delivery_at\": (\n      $actualDate := interchanges[0]\n        .groups[0]\n        .transaction_sets[0]\n        .heading\n        .assigned_number_LX_loop[0]\n        .shipment_status_details_AT7_loop[0]\n        .shipment_status_details_AT7;\n      $convertDateTime($actualDate.date_05 & $actualDate.time_06, \"yyyyMMddHHmm\", $dateTime.RFC3339Millis, \"UTC\", \"-05:00\")\n    ),\n    \"fulfillment_id\": $number(\n      interchanges[0]\n        .groups[0]\n        .transaction_sets[0]\n        .heading\n        .beginning_segment_for_transportation_carrier_shipment_status_message_B10\n        .shipment_identification_number_02\n    ),\n    \"happened_at\": (\n      $actualDate := interchanges[0]\n        .groups[0]\n        .transaction_sets[0]\n        .heading\n        .assigned_number_LX_loop[0]\n        .shipment_status_details_AT7_loop[0]\n        .shipment_status_details_AT7;\n      $convertDateTime($actualDate.date_05 & $actualDate.time_06, \"yyyyMMddHHmm\", $dateTime.RFC3339Millis, \"UTC\", \"-05:00\")\n    ),\n    \"id\": $number(\n      interchanges[0]\n        .groups[0]\n        .transaction_sets[0]\n        .heading\n        .beginning_segment_for_transportation_carrier_shipment_status_message_B10\n        .reference_identification_01\n    ),\n    \"message\": (\n      $statusCode := interchanges[0]\n        .groups[0]\n        .transaction_sets[0]\n        .heading\n        .assigned_number_LX_loop[0]\n        .shipment_status_details_AT7_loop[0]\n        .shipment_status_details_AT7\n        .shipment_status_code_01;\n      $lookupTable($tables.statusMessage, \"Key\", $statusCode).Value\n    ),\n    \"order_id\": $number(\n      interchanges[0].groups[0].transaction_sets[0].heading.business_instructions_and_reference_number_L11[0].reference_identification_01\n    ),\n    \"province\": interchanges[0].groups[0].transaction_sets[0].heading.name_N1_loop[1].geographic_location_N4.state_or_province_code_02,\n    \"shop_id\": $number(\n      interchanges[0]\n        .groups[0]\n        .transaction_sets[0]\n        .heading\n        .beginning_segment_for_transportation_carrier_shipment_status_message_B10\n        .reference_identification_01\n    ),\n    \"status\": (\n      $status := interchanges[0]\n        .groups[0]\n        .transaction_sets[0]\n        .heading\n        .assigned_number_LX_loop[0]\n        .shipment_status_details_AT7_loop[0]\n        .shipment_status_details_AT7\n        .shipment_status_code_01;\n      $lookupTable($tables.status, \"Key\", $status).Value\n    ),\n    \"updated_at\": (\n      $actualDate := interchanges[0]\n        .groups[0]\n        .transaction_sets[0]\n        .heading\n        .assigned_number_LX_loop[0]\n        .shipment_status_details_AT7_loop[0]\n        .shipment_status_details_AT7;\n      $convertDateTime($actualDate.date_05 & $actualDate.time_06, \"yyyyMMddHHmm\", $dateTime.RFC3339Millis, \"UTC\", \"-05:00\")\n    ),\n    \"zip\": interchanges[0].groups[0].transaction_sets[0].heading.name_N1_loop[1].geographic_location_N4.postal_code_03,\n    \"tracking_numbers\": [\"88b451840563b72cc15d3fcb6179f302\", \"aee587edbd98ad725d27974c808ec7d6\", \"94e71192ecf091ea5c25b69c385c2b1b\"]\n  }\n}"
}